<!DOCTYPE html><html lang="en"><head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta http-equiv="X-UA-Compatible" content="ie=edge"> <title>OCT ANGIO ANALIZATOR</title> <link rel="icon" href='data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gNzUK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8IAEQgADQAZAwERAAIRAQMRAf/EABcAAAMBAAAAAAAAAAAAAAAAAAYHCAT/xAAaAQEAAgMBAAAAAAAAAAAAAAAFAwYBAgQH/9oADAMBAAIQAxAAAAFA++Ea6ym7yNZfAyXg2akpHxzkKlqWqf/EABsQAAICAwEAAAAAAAAAAAAAAAMEBQYAAQIT/9oACAEBAAEFAn1SImY0uFCaq0FzVfXOJXpw4ILZMsFUEoln/8QAKhEAAQIEBAMJAAAAAAAAAAAAAQIDAAQFESExQWEGEPATFSJRUnGRsfH/2gAIAQMBAT8BZBcUW0jHLI9GE01+wJbV8GHZFxsBRSUx2e5ilMJ7/So4+Ii2mf37xMcQPonVoDYwuc1+ROit/wAh+vTFRbUw6kWx9eg3Xbq/L//EAC0RAAECAwQHCQAAAAAAAAAAAAIBEQADBAUhMUEGExVRYYGhEBQiU3GT0eHw/9oACAECAQE/Aa606cpcmofwOhPgnXPpFfpcaTpkilIGR2J357l4Y+kUulVUs3VVCoYcR5uyfmvjbJ+RK9sYn1p7N7uODfd26BsUTkazWLcKKzJm93SJdnBLUSEsUVcsn+Oz/8QAJhAAAQMCBQMFAAAAAAAAAAAAAQIDEQAEEhMhIkEFMZEQMjNh4f/aAAgBAQAGPwLLcjEDwatlt43LxSiXGyNgSO33Jp/qKCLW6QCcpLukgxEKk17U+KQw802tQcAS7EFKRO3TirVo3O1xeV8SeAn88V1S1zsYtLcvhRbEk6c9+fT/xAAgEAACAgEDBQAAAAAAAAAAAAABESExAEFRYRCBkdHh/9oACAEBAAE/IRnjHL5VhsJq8tt5FxEguBtOowD8s6Zs5oO28f58TmeWpYQMx4w+XJEiq2WJuB29miL7OBAezp0//9oADAMBAAIAAwAAABC4zjz/xAAeEQEBAAICAgMAAAAAAAAAAAABESExAEFR4RBhgf/aAAgBAwEBPxBTCdNi4JTb6vXnn5RPVwmpZkS4cCzPfeknZHseDfQ0lYrKO0YWqL3ENNESA2WxHYcA1QTjFnlaoq0ErxRjgUPj/8QAHREBAQEBAAMBAQEAAAAAAAAAAREhMQBBUXHB8P/aAAgBAgEBPxATs0AIHdjFDvUW8IdgXIAxKirB0ag0c3CsxklLIZOnT75/kP54RFNH3Wg4sfBj2Cqp8gqSCWp69pq8+o8vE9mMB389n75//8QAGhABAQEBAQEBAAAAAAAAAAAAAREhMQBBUf/aAAgBAQABPxA28kJck0gEhRx+AVfvXI4hy0GuTJ9HkG7ZQjkQQw9sN5lkwICI2jOe4TfHHKgFT9j6Wg+IK4pUKhG9XkAEnv/Z' type="image/gif" sizes="16x16"> <style>body{min-height: 100vh; padding: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; background:url('data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gNzUK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8IAEQgADQAZAwERAAIRAQMRAf/EABcAAAMBAAAAAAAAAAAAAAAAAAYHCAT/xAAaAQEAAgMBAAAAAAAAAAAAAAAFAwYBAgQH/9oADAMBAAIQAxAAAAFA++Ea6ym7yNZfAyXg2akpHxzkKlqWqf/EABsQAAICAwEAAAAAAAAAAAAAAAMEBQYAAQIT/9oACAEBAAEFAn1SImY0uFCaq0FzVfXOJXpw4ILZMsFUEoln/8QAKhEAAQIEBAMJAAAAAAAAAAAAAQIDAAQFESExQWEGEPATFSJRUnGRsfH/2gAIAQMBAT8BZBcUW0jHLI9GE01+wJbV8GHZFxsBRSUx2e5ilMJ7/So4+Ii2mf37xMcQPonVoDYwuc1+ROit/wAh+vTFRbUw6kWx9eg3Xbq/L//EAC0RAAECAwQHCQAAAAAAAAAAAAIBEQADBAUhMUEGExVRYYGhEBQiU3GT0eHw/9oACAECAQE/Aa606cpcmofwOhPgnXPpFfpcaTpkilIGR2J357l4Y+kUulVUs3VVCoYcR5uyfmvjbJ+RK9sYn1p7N7uODfd26BsUTkazWLcKKzJm93SJdnBLUSEsUVcsn+Oz/8QAJhAAAQMCBQMFAAAAAAAAAAAAAQIDEQAEEhMhIkEFMZEQMjNh4f/aAAgBAQAGPwLLcjEDwatlt43LxSiXGyNgSO33Jp/qKCLW6QCcpLukgxEKk17U+KQw802tQcAS7EFKRO3TirVo3O1xeV8SeAn88V1S1zsYtLcvhRbEk6c9+fT/xAAgEAACAgEDBQAAAAAAAAAAAAABESExAEFRYRCBkdHh/9oACAEBAAE/IRnjHL5VhsJq8tt5FxEguBtOowD8s6Zs5oO28f58TmeWpYQMx4w+XJEiq2WJuB29miL7OBAezp0//9oADAMBAAIAAwAAABC4zjz/xAAeEQEBAAICAgMAAAAAAAAAAAABESExAEFR4RBhgf/aAAgBAwEBPxBTCdNi4JTb6vXnn5RPVwmpZkS4cCzPfeknZHseDfQ0lYrKO0YWqL3ENNESA2WxHYcA1QTjFnlaoq0ErxRjgUPj/8QAHREBAQEBAAMBAQEAAAAAAAAAAREhMQBBUXHB8P/aAAgBAgEBPxATs0AIHdjFDvUW8IdgXIAxKirB0ag0c3CsxklLIZOnT75/kP54RFNH3Wg4sfBj2Cqp8gqSCWp69pq8+o8vE9mMB389n75//8QAGhABAQEBAQEBAAAAAAAAAAAAAREhMQBBUf/aAAgBAQABPxA28kJck0gEhRx+AVfvXI4hy0GuTJ9HkG7ZQjkQQw9sN5lkwICI2jOe4TfHHKgFT9j6Wg+IK4pUKhG9XkAEnv/Z'); background-size: cover; background-repeat: no-repeat; background-position: center; background-color: rgb(255, 228, 196);}#tablica{margin-bottom: 30px; margin-top: 30px;}#file{margin: 20px;}canvas{margin: 10px;}img{margin: 10px;}nav{display: flex; top: 0; position: fixed; width: 100%; padding-right:25px; padding-left: 10px; background-color: darkblue;}nav a{color: azure; text-decoration: none; text-align: center; padding: 14px 16px; transition: all 0.3s; font-weight: bolder; text-transform: uppercase;}nav a:hover{background-color: deepskyblue; color: whitesmoke;}h1{padding: 14px 16px; color: darkblue; font-weight: bolder; font-stretch: extra-expanded; font-size: 300%; text-align: center;}h4{text-transform: uppercase;}h2{text-transform: uppercase;}table{color: darkblue; padding: 10px 13px; width: 100%;}td, tr{text-align: center; padding: 14px 16px; font-weight: bolder; text-transform: uppercase;}.kontejner{background-color: rgba(245, 245, 245, 0.884); padding: 14px 20px; color: darkblue;}hr{padding: 10px;}#kontejnertablica{display:none;}#spiner{height: 100%; background-color:bisque; border-radius: 50%; color:darkblue; font-size: 20px; padding: 10px; margin-left:auto; cursor: default;}</style></head><body> <nav> <a href="#" id='izaberi' class="gumb">Izaberi datoteku</a> <a href="#" id='obrada' class="gumb" onclick="napraviTablicuObrade ()">Prika≈æi obradu </a> <a href="#" id="link">Skini tablicu</a> <a href="#" id="spiner">üê¢</a> </nav> <div class="kontejner" id='kontejner'> <h1>OCT ANGIO ANALIZATOR ≈ΩBƒå</h1> <input type="file" name="datoteke" id="file" accept=".jpg, .jpeg, .png, .bmp" multiple> <h4 id="prikazdat"></h4> <br><table id="tablica" class="tablica"> <tr> <th>Slika naslov</th> <th>udio ≈æila i kapilara u %</th> </tr></table> </div><br><div class="kontejner" id="kontejnertablica"> </div></body>
<script>
    //***********************OBRADA ANGIO OCT  ≈ΩBƒå***************************************
    // VERZIJA 1.0.1.
    //AUTOR VLATKO VUƒåENIK 10.12.2019

    const napraviTablicu=function(e=[],a){let t=document.createElement("table");t.setAttribute("class","tablica");let n=document.createElement("tr"),r=document.createElement("th"),i=document.createElement("th");return r.textContent="Slika naslov",n.appendChild(r),i.textContent="udio ≈æila i kapilara u%",n.appendChild(i),t.appendChild(n),e.forEach(e=>{let a=document.createElement("tr"),n=document.createElement("td"),r=document.createElement("td");n.innerText=e.naslov,a.appendChild(n),r.innerText=e.prosjek,a.appendChild(r),t.appendChild(a)}),t},napraviTablicuObrade=function(){for(kontejnerTablica.style.display="block";kontejnerTablica.firstChild;)kontejnerTablica.removeChild(kontejnerTablica.firstChild);console.log("obrada",obrada);let e=obrada.deepObrada.odstupanjeOdSredine,a=obrada.deepObrada.aritmetiƒçkaSredina,t=obrada.deepObrada.medijan,n=obrada.deepObrada.raspon[0],r=obrada.deepObrada.raspon[1],i=obrada.deepObrada.varijanca,d=obrada.deepObrada.standardnaDevijacija,o=obrada.deepObrada.rsd,l=obrada.superfObrada.aritmetiƒçkaSredina,s=obrada.superfObrada.medijan,u=obrada.superfObrada.raspon[0],p=(obrada.superfObrada.raspon[1],obrada.superfObrada.odstupanjeOdSredine),c=obrada.superfObrada.varijanca,h=obrada.superfObrada.rsd,j=obrada.superfObrada.standardnaDevijacija?obrada.superfObrada.standardnaDevijacija:"",b=`<h4> Aritmetiƒçka sredina ${a} </h4>\n<h4> Medijan ${t} </h4>\n<h4> Raspon ${n} - ${r} </h4>\n<h4> Prosjeƒçno odstupanje od aritmetiƒçke sredine ${e} </h4>\n<h4> Varijanca ${i} </h4>\n<h4> Standardna devijacija ${d} </h4>\n<h4> Relativna standardna devijacija ${o} </h4>\n`,m=`<h4> Aritmetiƒçka sredina ${l} </h4>\n<h4> Medijan ${s} </h4>\n<h4> Raspon ${u} - ${obrada.superfObrada.raspon[1]} </h4>\n<h4> Prosjeƒçno odstupanje od aritmetiƒçke sredine ${p} </h4>\n<h4> Varijanca ${c} </h4>\n<h4> Standardna devijacija ${j} </h4>\n<h4> Relativna standardna devijacija ${h} </h4>\n`;kontejnerTablica.insertAdjacentHTML("afterBegin"," <h2>Obrada DEEP</h2>"),kontejnerTablica.appendChild(napraviTablicu(obrada.deep)),kontejnerTablica.insertAdjacentHTML("beforeEnd",b),kontejnerTablica.insertAdjacentHTML("beforeEnd"," <h2>Obrada superficijal</h2>"),kontejnerTablica.appendChild(napraviTablicu(obrada.superf)),kontejnerTablica.insertAdjacentHTML("beforeEnd",m)},napraviRGB=(e=[])=>{let a=[];e.data.length;for(let t=0;t<e.data.length;t+=4){let n=[];n.push(e.data[t]),n.push(e.data[t+1]),n.push(e.data[t+2]),n.push(e.data[t+3]),a.push(n)}return a},raspodjela=function(e=[]){let a=e.reduce((e,a)=>((a[0]<51||a[1]<51||a[2]<51)&&(e[0]=e[0]+1),(a[0]<102&&a[0]>51||a[1]<102&&a[1]>51||a[2]<102&&a[2]>51)&&(e[1]=e[1]+1),(a[0]<153&&a[0]>102||a[1]<153&&a[1]>102||a[2]<153&&a[2]>102)&&(e[2]=e[2]+1),(a[0]<204&&a[0]>153||a[1]<204&&a[1]>153||a[2]<204&&a[2]>153)&&(e[3]=e[3]+1),(a[0]>204||a[1]>204||a[2]>204)&&(e[4]=e[4]+1),e),[0,0,0,0,0]);return a=a.map(a=>(a/e.length*100).toFixed(1))},obrniRGB=(e=[])=>{let a=[];e.data.length;for(let t=0;t<e.data.length;t+=4){a.push(255-e.data[t]),a.push(255-e.data[t+1]),a.push(255-e.data[t+2]),a.push(e.data[t+3])}return a},dajProsjekRgb=function(e=[]){let a=e.reduce((e,a)=>(e[0]=e[0]+a[0],e[1]=e[1]+a[1],e[2]=e[2]+a[2],e[3]=e[3]+a[3],e),[0,0,0,0]);return a=a.map(a=>a/e.length),a=Math.ceil(a[0])},rafiniraj=function(e=[],a=110){return e.reduce((e,t)=>(t[0]<a||t[1]<a||t[2]<a?e.push([255,255,255,255]):t[0]>153||t[1]>153||t[2]>153?e.push([255,0,0,255]):t[0]<153&&t[0]>a||t[1]<153&&t[1]>a||t[2]<153&&t[2]>a?e.push([0,255,0,255]):e.push([255,255,255,255]),e),[])},prosjekRafinirani=function(e=[],a=110){return e.filter(e=>e[0]<a||e[1]<a||e[2]<a).length/e.length},napraviObjekt=function(e="",a=0,t=0){let n=e;return{naslov:e,prosjek:a,rgbprosjek:t,deep:/deep/gi.test(n),superf:/superficial/gi.test(n)}},arimetickaSredina=function(e=[]){return(e.reduce((e,a)=>e+Number(a),0)/(e.length||1)).toFixed(2)},medijan=function(e=[]){let a=[...e];if(a.sort((e,a)=>e-a),a.length){let e=a.length,t=Math.floor(e/2);if(e%2==0){return((Number(a[t-1])+Number(a[t]))/2).toFixed(2)}return Number(a[t]).toFixed(2)}},raspon=function(e=[]){let a=[...e];return a.sort((e,a)=>e-a),(Number(a[a.length-1])-Number(a[0])).toFixed(2)},prosAbOdstOdAritSred=function(e=[],a=arimetickaSredina(e)){return(e.reduce((e,t)=>e+Math.abs(Number(t)-a),0)/e.length).toFixed(2)},varijanca=function(e=[],a=arimetickaSredina(e)){return(e.reduce((e,t)=>e+Math.pow(Number(t)-a,2),0)/e.length).toFixed(4)},stanDevijacija=function(e=[]){return Math.sqrt(varijanca(e)).toFixed(4)},frekvencija=function(e=[]){let a=[...e].sort((e,a)=>e-a),t=a[0],n=0,r=[];const i=function(e,a){return[e,a]};return r=a.reduce((e,r,d)=>(r===t?(n++,d===a.length-1&&e.push(i(t,n))):(e.push(i(t,n)),n=1,t=r,d===a.length-1&&e.push(i(t,n))),e),[])},grupiranjeFrekvencija=function(e=[],a=1){let t=frekvencija(e);const n=t.length;let r=t[0][0],i=0,d=[];for(let e=0;e<n-1;e++)t[e][0]-r<a?(i+=t[e][1],e===n-2&&d.push(i)):(d.push(i),i=t[e][1],r=t[e][0],e===n-2&&(d.push(t[n-2][1]),d.push(t[n-1][1])));return d},dajNajmanje=function(e,a){let t=[];for(let n=0;n<a;n++)t.push(e[0]);return t},relativnoStandardnoOdstupanje=function(e=[]){let a=arimetickaSredina(e);return(stanDevijacija(e)/a*100).toFixed(2)},napraviObradu=function(e=[],a=e[0]){let t=e.slice(1,e.length);return{"aritmetiƒçkaSredina":arimetickaSredina(e),medijan:medijan(e),raspon:[e[0],e[e.length-1]],odstupanjeOdSredine:prosAbOdstOdAritSred(e,this.arimetickaSredina),varijanca:varijanca(e,this.aritmetiƒçkaSredina),standardnaDevijacija:stanDevijacija(e),najmanji:a,rsd:relativnoStandardnoOdstupanje(e),standarDevBezNajmanjeg:stanDevijacija(t)}},obradaPodataka=function(e=[]){let a=e.filter(e=>e.deep).sort((e,a)=>e.prosjek-a.prosjek),t=e.filter(e=>e.superf).sort((e,a)=>e.prosjek-a.prosjek),n=a.length>0?a.map(e=>e.prosjek):[0],r=t.length>0?t.map(e=>e.prosjek):[0];return{deep:a,superf:t,deepObrada:napraviObradu(n,a[0]),superfObrada:napraviObradu(r,t[0])}};let stanje=[],obrada=[];const kontejner=document.getElementById("kontejner"),kontejnerTablica=document.getElementById("kontejnertablica"),spiner=document.getElementById("spiner"),tablica=document.getElementById("tablica"),link=document.getElementById("link");link.download="tablica.txt",link.addEventListener("click",e=>{let a,t=Date.now(),n=prompt("Unesite ime datoteke","Datoteka");if(null==n||""==n)return;a=n+" "+t+" JSON.json",link.download=a;let r={};r=Object.assign({},obrada);let i=JSON.stringify(r),d=new Blob([i],{type:"text/plain"});link.href=URL.createObjectURL(d),URL.revokeObjectURL(link.herf)});const fileInput=document.getElementById("file");fileInput.style.display="none";const prikazDat=document.getElementById("prikazdat");fileInput.addEventListener("change",()=>{prikazDat.innerHTML="",prikazDat.innerHTML=fileInput.files[0].name,gumb()});const izaberi=document.getElementById("izaberi");function gumb(e){let a=fileInput.files.length;setTimeout(window.requestAnimationFrame(()=>spiner.innerHTML=`${a} üêá`),200);for(let e=0;e<fileInput.files.length;e++){let t=fileInput.files[e],n=t.name;const r=document.createElement("img"),i=document.createElement("div"),d=document.createElement("tr"),o=document.createElement("td"),l=document.createElement("td"),s=document.createElement("td"),u=new FileReader;u.readAsDataURL(t),u.onload=function(){a--,r.src=u.result,r.onload=(()=>{spiner.innerHTML=`${a} üêá`,0===Number(a)&&setTimeout(()=>spiner.innerHTML="üêú ",5e3),kontejner.appendChild(r);let e=document.createElement("canvas"),t=document.createElement("canvas");const u=e.getContext("2d"),p=t.getContext("2d");e.width=r.width,e.height=r.height,t.width=r.width,t.height=r.height,u.drawImage(r,0,0);const c=u.getImageData(0,25,e.width,e.height-25,0,e.width,e.height-25),h=napraviRGB(c);let j=dajProsjekRgb(h);let b=rafiniraj(h,j).flat(),m=Uint8ClampedArray.from(b);const f=new ImageData(m,t.width,t.height-25);let k=100*(1-prosjekRafinirani(h));k=k.toFixed(2);let g=j;i.innerHTML=` RGB Prosjek ${g}  <br> \n    relativni postotak ≈æila na ukupnoj na slici ${k} %`,o.innerText=n,s.textContent=k,l.textContent=g,d.appendChild(o),d.appendChild(s),tablica.append(d),p.putImageData(f,0,0);let v=document.createElement("h4");v.innerHTML=n,kontejner.appendChild(v),kontejner.appendChild(t),kontejner.appendChild(i),stanje.push(napraviObjekt(n,k,g)),obrada=Object.assign(obrada,obradaPodataka(stanje))})}}}izaberi.addEventListener("click",e=>{fileInput&&fileInput.click()},!1);
   
</script>

</html>