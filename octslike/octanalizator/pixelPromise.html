<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>OCT ANGIO ANALIZATOR</title>
    <link rel="icon"
      href="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxANDQ8NDQ0QDQ8NEBENDQ8PDg8QDQ0QFhEWFhUVExMYHSghGBooGxYTITUtJykrLjouGB8zODMsNygwOisBCgoKDg0OGxAQGy4lHyUtLS0tLS0tKy0tLS0tLy0vLS0tKy0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0rKy0tLf/AABEIAOEA4QMBEQACEQEDEQH/xAAcAAEAAwADAQEAAAAAAAAAAAAAAQYHAwUIBAL/xABIEAABAwECBwkMCAUFAAAAAAAAAQIDBAURBgcSITFUkxYXNGFxcrGz0hMVMjVBUVVzdJHD0RQzUoGSlKOyIiNCRKEkJYLB8P/EABsBAQACAwEBAAAAAAAAAAAAAAABBQIDBAYH/8QAMREBAAECAgYHCQEBAAAAAAAAAAECAwQRBRQxMlFSBhITFSEzcRYiNEFTYYGRobEk/9oADAMBAAIRAxEAPwDcQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACFA6q0MI6Olf3Ooq4Yn6ch0iZScqGFVymnbLotYO/djOiiZfLu0s30hBtEI7Wji3d24r6c/o3aWb6Qg/Gg7Wjid24r6cm7SzfSEH40I7Wjid24r6cm7KzfSEG0QntqOKO7cV9Of07KzbVgq2q+mnZO1FuVY3I65eO7QZ01RVsc92xctTlcpmH3IS1AAAAIHzVtbHAxZJpGxMTS57ka33qZU0zVOUQwrrppjOqcodZuts/XoPxobtVvcrTrdnmg3W2fr0H40Gq3uWTW7PNButs/XoPxoNVvcsmt2eaDdbZ+vQfjQate5TW7PNDlpsJKKZ6RxVkL3uzNakjcp3InlMarFymM5pZU4m1VOUVO2Q1N6QAAAAAAAAAABxzrc1yp5EVf8ABEppjOYeZ6qZ0kkkj3K573uc9yrerlVSpr3pfTsLbpotUxHCHGYOgBmAzALfirncy1o2NVUbLHI16eRyI3KS9OVDqwtXvZPP9IbdM4brfPNuCFg8QkAAAhSJGWY3ZnfSqeO9chIlejfJlK9Uv9yIXGjKYnOVJpWrxiFBvLhTJvA+61LNfTJAr/7iBlQnFlKub/Ce85rN/r5xwlvu2ZoiJn5vgOhoTx6FTOippRfOhhVGcMqZyl6BsOV0lJTyPW9z4YnOXzqrEVVPL3Iyrl62xOdES7AwbQAAAAAAAAAA4qjwHc1egidjKneh5lfpXlXpKira+n2PLp9IQYtoAAAWrFf44p+bN1anRht9R9IPhPzDdULJ4VIAABCgZRjb4bT+o+I4udF7JUWld6FcsWwn12U2nliWZiK5YZFVj3N+0xblR3HouOu7iYtT70OK1h5u7sv2uC1Y2aOGWllYkkjY8tG5caIrkS9XsvRNPnMKsZbqomaZ8WdOEuU1xEwu+M6xlfBSvgic90Lu4ZEbHOdkObmua1PIrU95XYC/FNc9fZKx0hYmaI6seMKhT4F1rmOkkiZSxsTKdJUyNY1rfKqol6p96IWNWOtROVPirqcDdy61XhDoZ2ta5yMfltRVRHZKtyuO5c6IdVEzMZy5a4iJyhveDnAaX2eHq2nl72/L1eH8uHZmDcAAAAAAAAAAHFUeA7mr0ETsZUb0PMr9K8q9JUVbX0+x5dPpCDFtAAAC1Yr/ABxT82bq1OjDb6j6QfCfmG6oWTwqQAACFAyjG3w2n9R8RS50X81FpXehSqaofE9ssb1Y+Ncpj2r/ABNXiLKuiK6cqtisormic6drccEbTlraOOeeFYnuzX6Gyon9bU0oi/8Ar0PNX6KaK5il6fD3Kq6Imp3aoaXRPiyTGRbdRJULRua6CCO5yNX+4z5nqqaW36E4s+fRc4DD24p6/wA1HpDEXJq6vyUlS1VLf8HOA0vs8PVoeVu78vW4fy4dma24AAAAAAAAAAOKo8B3Nd0EVbGVO9DzK/SvKvSVFW19PseXT6QgxbQAAAtWK/xxT82bq1OjDb6j6QfCfmG6oWTwqQAACFIkZRjb4bB6j4il1ovZKh0rvw6DByOjY/u9oS3sYt7KZjXPfM5Pt3Zkbyrn5NPRiZu1e5RDlw8WonrXFz3yo1mijipVZE6RjHvkejVaxXIiqjG3po4zgq0dXFPWqlYxpOmaopphYcMcI+9sMcjY0ldJJkIxXZN6XKqrf9ye85cNYm7V1XZisVFmjrcVQtXCiz7Uh7lVxy0sjb1imRiSJE5eNudW+dLvmdtGFvWKs6PGFfcxVm/TlX4SodRHkOc1HNejb0RzFvY5POiltRVNUZyqa6YpnKG94OcBpfZ4erQ8xd35erw/lw7M1twAAAAAAAAAAcVR4Dua7oIq2MqN6HmV+leVekqKtr6fY8un0hBi2gAAErXivT/eKfmzdWp04XfUXSDwwn5huiFi8KkAAAhRIyjG3w2n9R8RxcaM2SotKx70KNeWypmUEVRnGSYqmJzWXDG3PpqUSX39ypmrJ612Z1/H/CnvOHCWJomr1dmLv9pFMK3ed7hReBv+DnAaX2eHq0PK3d+XrsP5cOzNbcAAAEKBVMLsN4bLe2JY3TzObl9za5Go1uhFc5dGhfcarl6KFlgNF3cXHWp8IVzfcT0e78wnZNOtxwWns1d54N9xPR7vzCdka1B7NXOeP0b7iej3fmE7I1qD2auc8fo33E9Hu/MJ2RrUHs1c54/T8vxtI5FT6A5L0VOEJ5f+JGtRPgiejtyiJr68eD5WYqJnoj/p0aZX8V3cH3pfn+0Rqsz45t1PSKKI6vU2fd+t6SbX4tg/tDVJ4svaWn6f9N6SbX4tg/tEapPE9pafp/03pJtfi2D+0NUnie0tP0/6jekm1+LYP7ROp/c9po5J/azYF4CssyVaiSbu8ytVjVRuQyNq6bkvVb1uQ3WrHZqnSWlq8ZHViMoXNDeqEgAAEKRIreF+CrLTaxctYpYkVGSZKOS5dKOb5U+86cLiarM/Zx4rCRfj7qnvWy69HsHdo7+9Psr+6auY3rZddj2Du0O9fsd01cxvWy67HsHdojvSOB3TVzG9bLrsewd2ie9Psd01cTetl12PYO7RHen2O6auLRrLplgp4oVXKWKNkauRLkXJaiX3fcVddXWqmVxbo6lMQ+sxbAAAAhQMNxpeN5fVxftK7Fbz3XR6P+WJ+8qkcy8AkAADKnbDC5uz6S9N0v1bOa3oLeNj5bXvS5SWJcDIuBki4BcBIAAAAARcAuAXATcAuAXALgAAAAAhQMNxp+OJvVw/sK7E7z3XR/4SPWVSOZeAAAAMqdsMbm5PpL03S/Vs5regt42Plte9LlJYgAAAAAAAAAAAAAAAAAAAAAACFAw3Gn44m9XD+wrsTvPddH/hI9ZVI5l4AAAAyp2wxubk+kvTdL9Wzmt6C3jY+W170uUliAAAAAAAAAAAAAAAAAAAAAAAIUDDcafjib1cP7CuxO8910f+Ej1lUjmXgAAADKnbDG5uT6S9N0v1bOa3oLeNj5bXvS5SWIAAAAAAAAAAAAAAAAAAAAAAAhQMPxqxubaz1VFRJIonMX7SIitW770K7FZ9Z7jo9XE4bKPlMqgcua+gJzTkDOTIGcoQpNM+MMbm5PpL03Sr/LZzW9BcRsfLa96XLeSwLwF4ShVCBFIS/RIAAAACLyMwvBmi8lGZeDMvBmXkJTeJEkgAAAFA6217Cpq5qNqoGzI1b2q69HN5HJnQxqoira3WcRcsznbnJ1G97ZeqfqS9ow7Cjg7e98Zzm97ZeqfqS/MjV7fA74xnOb3tl6p+pL8xq9vgd8YznN72y9U/Ul7Q1e3wO98Zzy/E2L+zEa5UpNCKqfzJPNyibFEfIjS2Lmcpr8GW7uLTS9ErXoiKqInc4cyIub+k4qr9eb1dvQ+EqpiZo2/eTd1aevP2cPZHb1s+5cHyf2Td1aevP2cPZHb1ncuD5P7Ju6tPXn7OHsjt6zuXB8n9k3c2nrz9nD2R29Z3Jg+X+yt+LjDOpqqr6HWPSbujXOikyWteitS9WrdmVLr/AHHRh701TlKj0zoq1h7cXLXh4tOQ63mkgAAEKBR8YuFE1EsVPTKjHytWR0itRytai3IjUXNeuf3HdgsNF2ZmVbj8VVa8KVG3a2lrjtnD2S0jAWPnCp1+/wDKo3bWlrjtnD2SdQscpr+I5v8ADdtaWuO2cPZGoWOU1/Ec3+G7a0tcds4eyNQscpr+I5v8Fw1tLXHbOHskTgbHKa/f5mx2HM6Skp5HrlPfDG96+dysRVX3qefuRlVMPR2ZzoiZfeYtoAAAAAAAAAAcVR4DuavQROxlRvQ8yv0ryr0lRVtfULHl0+kIIbQAACFqxX+OKfmzdWp0YbfUfSD4T8w3VCxeFSAAAQBlGNtf9bB7P8RS50XslRaV3oUUtVQAAABQN/wc4DS+zw9W08rdj35euw/lw7M1twAAAAAAAAAAcVR4DuavQROxlRvQ8yv0ryr0lRVtl9PseXT6QgxbQAAAtWK/xxT82bq1OjDb6j6QfCfmG6oWTwqQAACFAyfG5w2n9n+Ipc6L2SotK70KMWqoAAAAoG/4OcBpfZ4erQ8rd35euw/lw7M1twAAAAAAAAAAcVR4DuavQROxlRvQ8yv0ryr0lRVtl9PseXT6QgxbQAAAtWK/xxT82bq1OjDb6j6QfCfmG6oWTwqQAACFAyfG5w2n9n+Ipc6L2SotK70KMWqoAAAAoG/4OcBpfZ4erQ8rd35euw/lw7M1twAAAAAAAAAAcVR4DuavQRVsZUb0PMr9K8q9JUVbX0+x5dPpCDFtAAAC1Yr/ABxT82bq1OjC76k6QfCfmG6oWTwiQAACFAyjG3w2n9n+Ipc6MnwlRaV3oUUtlQAAAAiR6Awc4DS+zw9Wh5W7vy9dY8uHZGtuAAAAAAAAAADjlS9qp50uInYROU5vPNs4PVVJO+J9PK65y5D2RveyRt+ZyKiFZctVRV4PoeC0jYuWqfeynJ8Pe+fVp9hL8jX1KuDr1uxzx+4O98+rT7CX5DqVcDW7HPH7hPe+fVp9hL8h1KuCdbsc8fuEd759Wn2EvyHUq4I1uxzx+13xWWBUfTm1kkT4ooWPRFkY5ivc5LkRqLn8+fkOrDW5ic5ef09jrVdqLVE5zm2BDueRSAAAQoGdY0rFnmfDVQxulYxixyIxquez+K9FuTOqZ19xZaPvU0TNNSo0jYrr96lnne+fV5tjJ8i47ajjCn7GvhJ3vn1ebYyfIdvRxOxr4Sd759Xm2MnyHbUcf6djc4Sd759Xm2MnyHbUcTsa+EualsWqmekcdNMrnZkvie1qcbnKlyIa7mJt0055sqMPcqnLJu9lU6w08MKresUTI1VNCq1qJ/0ebrnOqZeptU5URD7DFsAAAAAAAAAACFQCMkIyTcEl3GAu4wZlwC4CQAAAAAi4BcEZFwMjJAXAyMkGUASkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//Z" 
        type="image/gif" sizes="16x16">
    <style>
        body {
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;

            background: url('data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gNzUK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8IAEQgADQAZAwERAAIRAQMRAf/EABcAAAMBAAAAAAAAAAAAAAAAAAYHCAT/xAAaAQEAAgMBAAAAAAAAAAAAAAAFAwYBAgQH/9oADAMBAAIQAxAAAAFA++Ea6ym7yNZfAyXg2akpHxzkKlqWqf/EABsQAAICAwEAAAAAAAAAAAAAAAMEBQYAAQIT/9oACAEBAAEFAn1SImY0uFCaq0FzVfXOJXpw4ILZMsFUEoln/8QAKhEAAQIEBAMJAAAAAAAAAAAAAQIDAAQFESExQWEGEPATFSJRUnGRsfH/2gAIAQMBAT8BZBcUW0jHLI9GE01+wJbV8GHZFxsBRSUx2e5ilMJ7/So4+Ii2mf37xMcQPonVoDYwuc1+ROit/wAh+vTFRbUw6kWx9eg3Xbq/L//EAC0RAAECAwQHCQAAAAAAAAAAAAIBEQADBAUhMUEGExVRYYGhEBQiU3GT0eHw/9oACAECAQE/Aa606cpcmofwOhPgnXPpFfpcaTpkilIGR2J357l4Y+kUulVUs3VVCoYcR5uyfmvjbJ+RK9sYn1p7N7uODfd26BsUTkazWLcKKzJm93SJdnBLUSEsUVcsn+Oz/8QAJhAAAQMCBQMFAAAAAAAAAAAAAQIDEQAEEhMhIkEFMZEQMjNh4f/aAAgBAQAGPwLLcjEDwatlt43LxSiXGyNgSO33Jp/qKCLW6QCcpLukgxEKk17U+KQw802tQcAS7EFKRO3TirVo3O1xeV8SeAn88V1S1zsYtLcvhRbEk6c9+fT/xAAgEAACAgEDBQAAAAAAAAAAAAABESExAEFRYRCBkdHh/9oACAEBAAE/IRnjHL5VhsJq8tt5FxEguBtOowD8s6Zs5oO28f58TmeWpYQMx4w+XJEiq2WJuB29miL7OBAezp0//9oADAMBAAIAAwAAABC4zjz/xAAeEQEBAAICAgMAAAAAAAAAAAABESExAEFR4RBhgf/aAAgBAwEBPxBTCdNi4JTb6vXnn5RPVwmpZkS4cCzPfeknZHseDfQ0lYrKO0YWqL3ENNESA2WxHYcA1QTjFnlaoq0ErxRjgUPj/8QAHREBAQEBAAMBAQEAAAAAAAAAAREhMQBBUXHB8P/aAAgBAgEBPxATs0AIHdjFDvUW8IdgXIAxKirB0ag0c3CsxklLIZOnT75/kP54RFNH3Wg4sfBj2Cqp8gqSCWp69pq8+o8vE9mMB389n75//8QAGhABAQEBAQEBAAAAAAAAAAAAAREhMQBBUf/aAAgBAQABPxA28kJck0gEhRx+AVfvXI4hy0GuTJ9HkG7ZQjkQQw9sN5lkwICI2jOe4TfHHKgFT9j6Wg+IK4pUKhG9XkAEnv/Z');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            background-color: rgb(255, 228, 196);
        }

        #tablica {
            margin-bottom: 30px;
            margin-top: 30px;
        }

        #file {
            margin: 20px;
        }

        canvas {
            margin: 10px;
        }

        img {
            margin: 10px;
        }

        nav {
            display: flex;
            top: 0;
            position: fixed;
            width: 100%;
            padding-right: 25px;
            padding-left: 10px;


            background-color: darkblue;

        }

        nav a {
            color: azure;
            text-decoration: none;
            text-align: center;
            padding: 14px 16px;
            transition: all 0.3s;
            font-weight: bolder;
            text-transform: uppercase;





        }

        nav a:hover {
            background-color: deepskyblue;
            color: whitesmoke;
        }

        h1 {
            padding: 14px 16px;
            color: darkblue;
            font-weight: bolder;
            font-stretch: extra-expanded;
            font-size: 300%;
            text-align: center;




        }

        h4 {
            text-transform: uppercase;
        }

        h2 {
            text-transform: uppercase;
        }

        table {
            color: darkblue;
            padding: 10px 13px;
            width: 100%;

        }

        td,
        tr {

            text-align: center;
            padding: 14px 16px;

            font-weight: bolder;
            text-transform: uppercase;
        }

        .kontejner {
            background-color: rgba(245, 245, 245, 0.884);


            padding: 14px 20px;
            color: darkblue;

        }

        hr {
            padding: 10px;
        }

        #kontejnertablica {
            display: none;
        }

        #spiner {
            height: 100%;
            background-color: bisque;
            border-radius: 50%;
            color: darkblue;
            font-size: 20px;
            padding: 10px;
            margin-left: auto;
            cursor: default;

        }
        #klizac{
            color:darkblue;
            text-transform: uppercase;

        }
        h3{
            color:darkblue;
            text-transform: uppercase;
        }
        #slider::-webkit-slider-thumb{
            -webkit-appearance: none;
            height: 30px;
            width:30px;
       border-radius: 50%;
            background:darkblue;
            cursor: pointer;
          

        }
        #slider{
            -webkit-appearance: none;
            height: 30px;
            width:100%;
            border-radius:15px;
     
            background:#d3d3d3;
            outline: none;
            opacity: 0.7;
            transition:opacity .2s;
           
          

        }
        #slider:hover{
            opacity: 1;
        }

    </style>
</head>

<body>
    <nav>

        <a href="#" id='izaberi' class="gumb">Izaberi datoteku</a>
        <a href="#" id='obrada' class="gumb" >Prika≈æi obradu </a>
        <a href="#" id="link">Skini tablicu</a>
        <a href="#" id="spiner">üê¢</a>

    </nav>

    <div class="kontejner" id='kontejner'>
        <h1>OCT ANGIO ANALIZATOR ≈ΩBƒå</h1>
        <input type="file" name="datoteke" id="file" accept=".jpg, .jpeg, .png, .bmp" multiple>
        <!-- <button id='izaberi' class="gumb">Izaberi datoteku</button>-->
        <h4 id="prikazdat"></h4>




        <br>



        <table id="tablica" class="tablica">
            <tr>
                <th>Slika naslov</th>
                <!-- <th>RGB pr.</th>-->
                <th>udio ≈æila i kapilara u %</th>
            </tr>



        </table>





    </div>
    <br>
    <div class="kontejner" id="kontejnertablica">

    </div>

    <div class="klizac">
        <h3>Raspon frekvencija u rasponu od</h3>
        <h3 id="brojac__slider">1</h3>
    <input type="range" name="korak" id="slider" min="1" max="10" step = "1" value="1">
</div>


</body>
<script>
    //***********************OBRADA ANGIO OCT  ≈ΩBƒå***************************************
    // VERZIJA 1.0.4.
    //AUTOR VLATKO VUƒåENIK 19.12.2019
    //******Funkcije html elementi
    const napraviTablicu = function (po = [], id) {

        let tablica = document.createElement('table');
        tablica.setAttribute('class', 'tablica');
        // tablica.setAttribute('id',id);
        let tr = document.createElement('tr');

        let th = document.createElement('th');
        let th1 = document.createElement('th');
        th.textContent = 'Slika naslov';
        tr.appendChild(th);
        th1.textContent = 'udio ≈æila i kapilara u%';
        tr.appendChild(th1);
        tablica.appendChild(tr);

        po.forEach(x => {
            let trp = document.createElement('tr');
            let td = document.createElement('td');
            let td1 = document.createElement('td');
            td.innerText = x.naslov;
            trp.appendChild(td);
            td1.innerText = x.prosjek;
            trp.appendChild(td1);
            tablica.appendChild(trp);

        })

        return tablica;



    }


    const napraviTablicuObrade = function () {
        kontejnerTablica.style.display = 'block';
        while (kontejnerTablica.firstChild) {
            kontejnerTablica.removeChild(kontejnerTablica.firstChild);
        }
        //console.log('obrada',obrada);
        let odstupanjeOdSredineDeep = obrada.deepObrada.odstupanjeOdSredine;
        let aritmetiƒçkaSredinaDeep = obrada.deepObrada.aritmetiƒçkaSredina;
        let medijanDeep = obrada.deepObrada.medijan;
        let raspon1Deep = obrada.deepObrada.raspon[0];
        let raspon2Deep = obrada.deepObrada.raspon[1];
        let varijancaDeep = obrada.deepObrada.varijanca;
        let devijacijaDeep = obrada.deepObrada.standardnaDevijacija;
        let rsdDeep = obrada.deepObrada.rsd;
        let najmanjielemDeep = obrada.deepObrada.najmanji.naslov;
        if (najmanjielemDeep === undefined) najmanjielemDeep = " - ";
        let devijacijaBezNajmanjeg = obrada.deepObrada.najmanji.naslov;
        let standarDevBezNajmanjegD = obrada.deepObrada.standarDevBezNajmanjeg;
        let rsdDepB = ((Number(standarDevBezNajmanjegD) / Number(aritmetiƒçkaSredinaDeep)) * 100).toFixed(2);
        if (isNaN(rsdDepB)) rsdDepB = 0;


        let aritmetiƒçkaSredinaF = obrada.superfObrada.aritmetiƒçkaSredina;
        let medinaF = obrada.superfObrada.medijan;
        let raspon1F = obrada.superfObrada.raspon[0];
        let raspon2F = obrada.superfObrada.raspon[1];
        let odstupanjeOdSredineF = obrada.superfObrada.odstupanjeOdSredine;
        let varijancaF = obrada.superfObrada.varijanca;
        let rsdF = obrada.superfObrada.rsd;
        let najmanjielemF = obrada.superfObrada.najmanji.naslov;

        if (najmanjielemF === undefined) najmanjielemF = " - ";

        let standarDevBezNajmanjegF = obrada.superfObrada.standarDevBezNajmanjeg;
        let rsdFB = ((Number(standarDevBezNajmanjegF) / Number(aritmetiƒçkaSredinaF)) * 100).toFixed(2);
        if (isNaN(rsdFB)) rsdFB = 0;
        // if(obrada.superfObrada.varijanca==!NaN){
        //     varijancaF = obrada.superfObrada.varijanca;
        // }
        //(obrada.superfObrada.varijanca===NaN)?"":obrada.superfObrada.varijanca;
        let devijacijaF = obrada.superfObrada.standardnaDevijacija ? obrada.superfObrada.standardnaDevijacija : "";

        //console.log('var',obrada.superfObrada.varijanca )

        let obradaDeep = `<h4> Aritmetiƒçka sredina ${aritmetiƒçkaSredinaDeep} </h4>
<h4> Medijan ${medijanDeep} </h4>
<h4> Raspon ${raspon1Deep} - ${raspon2Deep} </h4>
<h4> Prosjeƒçno odstupanje od aritmetiƒçke sredine ${odstupanjeOdSredineDeep} </h4>
<h4> Varijanca ${varijancaDeep} </h4>
<h4> Standardna devijacija ${devijacijaDeep} </h4>
<h4> Relativna standardna devijacija ${rsdDeep} </h4>
<h4> Najmanja gustoƒáa ≈æila ${najmanjielemDeep} </h4>
<h4> Standardna devijacija bez najmanjeg elementa ${standarDevBezNajmanjegD}  RSD ${rsdDepB} </h4>
`
        let obradaSuper = `<h4> Aritmetiƒçka sredina ${aritmetiƒçkaSredinaF} </h4>
<h4> Medijan ${medinaF} </h4>
<h4> Raspon ${raspon1F} - ${obrada.superfObrada.raspon[1]} </h4>
<h4> Prosjeƒçno odstupanje od aritmetiƒçke sredine ${odstupanjeOdSredineF} </h4>
<h4> Varijanca ${varijancaF} </h4>
<h4> Standardna devijacija ${devijacijaF} </h4>
<h4> Relativna standardna devijacija ${rsdF} </h4>
<h4> Najmanja gustoƒáa ≈æila ${najmanjielemF} </h4>
<h4> Standardna devijacija bez najmanjeg elementa ${standarDevBezNajmanjegF}  RSD ${rsdFB} </h4>
`
        kontejnerTablica.insertAdjacentHTML('afterBegin', ' <h2>Obrada DEEP</h2>');
        kontejnerTablica.appendChild(napraviTablicu(obrada.deep, 'pr'));
        kontejnerTablica.insertAdjacentHTML('beforeEnd', obradaDeep);
        kontejnerTablica.insertAdjacentHTML('beforeEnd', ' <h2>Obrada superficijal</h2>');
        kontejnerTablica.appendChild(napraviTablicu(obrada.superf, 'pr'));
        kontejnerTablica.insertAdjacentHTML('beforeEnd', obradaSuper);


    }



    // vewrzija 2

    const napraviTablicuObrade2 = function(obrada={}){
        //console.log('tablica obrade',obrada);
    
    //console.log('kon',kontejnerTablica);


   
    kontejnerTablica.style.display = 'block';
while (kontejnerTablica.firstChild) {
    kontejnerTablica.removeChild(kontejnerTablica.firstChild);
}
//console.log('obrada',obrada);
let odstupanjeOdSredineDeep = obrada.deepObrada.odstupanjeOdSredine;
let aritmetiƒçkaSredinaDeep = obrada.deepObrada.aritmetiƒçkaSredina;
let medijanDeep = obrada.deepObrada.medijan;
let raspon1Deep = obrada.deepObrada.raspon[0];
let raspon2Deep = obrada.deepObrada.raspon[1];
let varijancaDeep = obrada.deepObrada.varijanca;
let devijacijaDeep = obrada.deepObrada.standardnaDevijacija;
let rsdDeep = obrada.deepObrada.rsd;


let aritmetiƒçkaSredinaF = obrada.superfObrada.aritmetiƒçkaSredina;
let medinaF = obrada.superfObrada.medijan;
let raspon1F = obrada.superfObrada.raspon[0];
let raspon2F = obrada.superfObrada.raspon[1];
let odstupanjeOdSredineF = obrada.superfObrada.odstupanjeOdSredine;
let varijancaF =obrada.superfObrada.varijanca ;
let rsdF = obrada.superfObrada.rsd;
// if(obrada.superfObrada.varijanca==!NaN){
//     varijancaF = obrada.superfObrada.varijanca;
// }
//(obrada.superfObrada.varijanca===NaN)?"":obrada.superfObrada.varijanca;
let devijacijaF = obrada.superfObrada.standardnaDevijacija?obrada.superfObrada.standardnaDevijacija:"";

//console.log('var',obrada.superfObrada.varijanca )

let obradaDeep = `<h4> Aritmetiƒçka sredina ${aritmetiƒçkaSredinaDeep} </h4>
<h4> Medijan ${medijanDeep} </h4>
<h4> Raspon ${raspon1Deep} - ${raspon2Deep} </h4>
<h4> Prosjeƒçno odstupanje od aritmetiƒçke sredine ${odstupanjeOdSredineDeep} </h4>
<h4> Varijanca ${varijancaDeep} </h4>
<h4> Standardna devijacija ${devijacijaDeep} </h4>
<h4> Relativna standardna devijacija ${rsdDeep} </h4>
`
let obradaSuper = `<h4> Aritmetiƒçka sredina ${aritmetiƒçkaSredinaF} </h4>
<h4> Medijan ${medinaF} </h4>
<h4> Raspon ${raspon1F} - ${obrada.superfObrada.raspon[1]} </h4>
<h4> Prosjeƒçno odstupanje od aritmetiƒçke sredine ${odstupanjeOdSredineF} </h4>
<h4> Varijanca ${varijancaF } </h4>
<h4> Standardna devijacija ${devijacijaF} </h4>
<h4> Relativna standardna devijacija ${rsdF} </h4>
`
kontejnerTablica.insertAdjacentHTML('afterBegin', ' <h2>Obrada DEEP</h2>');
kontejnerTablica.appendChild(napraviTablicu(obrada.deep, 'pr'));
kontejnerTablica.insertAdjacentHTML('beforeEnd', obradaDeep);
kontejnerTablica.insertAdjacentHTML('beforeEnd', ' <h2>Obrada superficijal</h2>');
kontejnerTablica.appendChild(napraviTablicu(obrada.superf, 'pr'));
kontejnerTablica.insertAdjacentHTML('beforeEnd', obradaSuper);


}


    //*********************FUNKCIJE**********************************

    // Funkcija uzima jednodimenzinalno polje pixla u unit8 clamp formatu jedan pixel je odreƒëen sa ƒçetiri elemenata polja RGBA
    const napraviRGB = (x = []) => {
        let polje = [];

        let duzina = x.data.length;
        // broj sve piksel i ƒçetri meƒáe u polje tako da je svaki piks u polju sa ƒçetri elementa broje krajnieg polja je broj piksla

        for (let i = 0; i < x.data.length; i = i + 4) {
            let rgb = [];
            //console.log(x.data[i]);
            rgb.push(x.data[i]);
            rgb.push(x.data[i + 1]);
            rgb.push(x.data[i + 2]);
            rgb.push(x.data[i + 3]);
            polje.push(rgb);
        }
        // polje u formatu [[rgba],[rgba].....]
        return polje;
    };


    /// funkcija za raƒçunanje rspodjele skupova u rasponu od 51 znaƒçi pet skupava koliko ima piksal u rasponu od 0-51 51-102 102-153 153-204 204-255 ulaz u formatu [[rgba],[rgba].....]

    const raspodjela = function (x = []) {
        // console.log('x',x);
        let racuna = x.reduce((ak, val) => {
            if (val[0] < 51 || val[1] < 51 || val[2] < 51) {
                ak[0] = ak[0] + 1
            };

            if ((val[0] < 102 && val[0] > 51) || (val[1] < 102 && val[1] > 51) || (val[2] < 102 && val[2] > 51)) {
                ak[1] = ak[1] + 1;
            }
            if ((val[0] < 153 && val[0] > 102) || (val[1] < 153 && val[1] > 102) || (val[2] < 153 && val[2] > 102)) {
                ak[2] = ak[2] + 1;
            };
            if ((val[0] < 204 && val[0] > 153) || (val[1] < 204 && val[1] > 153) || (val[2] < 204 && val[2] > 153)) {
                ak[3] = ak[3] + 1;
            };
            if ((val[0] > 204) || (val[1] > 204) || (val[2] > 204)) {
                ak[4] = ak[4] + 1;
            };

            return ak;

        }, [0, 0, 0, 0, 0])
        //console.log('racuna', racuna);
        racuna = racuna.map(y => {
            return ((y / x.length) * 100).toFixed(1)

        });
        // racuna[0]= ((racuna[0]/x.length)*100).toFixed(1);
        // racuna[1]= ((racuna[1]/x.length)*100).toFixed(1);
        // racuna[2]= ((racuna[2]/x.length)*100).toFixed(1);
        // racuna[3]= ((racuna[3]/x.length)*100).toFixed(1);
        // racuna[4]= ((racuna[4]/x.length)*100).toFixed(1);

        return racuna;
    }



    ///Funkcija uzima polje piksla u jednodimenzionlnom polju[r,g,b,a,r,g,b,a.....] te svaki kanal boje okreƒáe sa formulom 255-r....
    const obrniRGB = (x = []) => {
        let polje = [];

        let duzina = x.data.length;

        for (let i = 0; i < x.data.length; i = i + 4) {
            let rgb = [];
            //console.log(x.data[i]);
            polje.push(255 - x.data[i]);
            polje.push(255 - x.data[i + 1]);
            polje.push(255 - x.data[i + 2]);
            polje.push(x.data[i + 3]);

        }
        //jednodimenzionlnom polju[r,g,b,a,r,g,b,a.....] 
        return polje;

    }
    /// funkcija naƒçina prosjeƒçnu vrijednost svih piksii u odreƒëenom kanalu npr R +R +R .../broj piksla te fraƒça s obzirom da je crno bijela slika samo jednu prosjeƒçnu vriijednos sive boje
    const dajProsjekRgb = function (x = []) {
        // console.log('x',x);
        let uk = x.reduce((ak, val) => {
            //  console.log('akaaaa',ak);
            ak[0] = ak[0] + val[0];
            ak[1] = ak[1] + val[1];
            ak[2] = ak[2] + val[2];
            ak[3] = ak[3] + val[3];
            return ak;

        }
            , [0, 0, 0, 0])
        uk = uk.map(y => y / x.length);
        // console.log('uk',uk);
        uk = Math.ceil(uk[0]);
        return uk;
    };
    // funkcija uzima polje oblika [[rgba],[rgba].....] te za odreƒëeni raspon pikslu u tom rasponu mjenja boju u r g ili u bjelu
    // sve crne i sive manje od prosjeka pretvara u bjele od prosjeka do 150 u zelene a ostale koji su veƒái od 150 u crvene
    const rafiniraj = function (po = [], pro = 110) {
        // console.log('polj',po);

        let rez = po.reduce((ak, val) => {
            if (val[0] < pro || val[1] < pro || val[2] < pro) {
                ak.push([255, 255, 255, 255])

            } else if (val[0] > 153 || val[1] > 153 || val[2] > 153) {
                ak.push([255, 0, 0, 255])
            } else if ((val[0] < 153 && val[0] > pro) || (val[1] < 153 && val[1] > pro) || (val[2] < 153 && val[2] > pro)) {
                ak.push([0, 255, 0, 255])
            }
            else {
                //ak.push(val);
                ak.push([255, 255, 255, 255])
            }

            return ak;

        }, [])
        //console.log('rez',rez);
        return rez;



    }
    /// funkcija uzima dva parametra polje u obliku [[rgba],[rgba].....]  raƒçuna broj piksi koji su tamniji od prosjeka sive kroz ukupan broj piksli znaƒçi kolik je udio tamnijih piksi od prosjeka na slici
    const prosjekRafinirani = function (po = [], pro = 110) {
        let poRaf = po.filter(val => (val[0] < pro || val[1] < pro || val[2] < pro));
        return poRaf.length / po.length;

    };

    // funkcija za pravljenje objkata pridru≈æenih  globalno polju stanje
    //Polje sadr≈æi objekte tipa {naslov:x,prosjek:y,rgbprosjek:z,deep:true,superf:false}

    const napraviObjekt = function (x = '', y = 0, z = 0) {
        let naslov = x;
        let deep = /deep/ig.test(naslov);
        let superf = /superficial/ig.test(naslov);
        // console.log('deep', deep);
        // console.log('superficijal', superf);
        return {
            naslov: x,
            prosjek: y,
            rgbprosjek: z,
            deep: deep,
            superf: superf

        }
    }



    const daliJeImeDeepiliSuperficijal = function(naslov){

        let deep = /deep/ig.test(naslov);
        let superf = /superficial/ig.test(naslov);
        return deep||superf;

    }
    // statistiƒçke funkcije uzimaju polje podataka i raƒçunaju

    //let polje = [30,1,12,8,1,7,24,4,4,6,20,10,3,2,22,23,8,6,5,25,16,3,1,14,15,18,2,6,27,19,12,4,20,14,3,13,8,15,30,5,7,16];



    const arimetickaSredina = function (po = []) {
        let zbroj = po.reduce((ak, val) => {
            return ak + Number(val);

        }, 0)
        let N = po.length || 1;
        return (zbroj / N).toFixed(2)
    }
    //console.log('aritmetiƒçka sredina',arimetickaSredina(polje));

    const medijan = function (po = []) {
        let po1 = [...po];
        po1.sort((a, b) => a - b);
        //console.log('polj',po1);
        if (po1.length) {
            let N = po1.length;
            //  console.log('n',N)
            let sredina = Math.floor(N / 2);
            //  console.log('sredina',po1[sredina])
            // console.log('sredina-1',po1[sredina-1])

            if (N % 2 === 0) {
                let a = Number(po1[(sredina - 1)]);
                let b = Number(po1[sredina]);
                let r = (a + b) / 2;

                return r.toFixed(2);
            } else {

                return Number(po1[sredina]).toFixed(2);
            }


        }
    }
    //console.log('medijan',medijan(polje))

    const raspon = function (po = []) {
        let sortirano = [...po];
        //console.log('sort',po,sortirano)
        sortirano.sort((a, b) => a - b);
        // console.log('sort',po,sortirano)

        return (Number(sortirano[(sortirano.length - 1)]) - Number(sortirano[0])).toFixed(2);
    }

    //console.log('raspon',raspon(polje))

    const prosAbOdstOdAritSred = function (po = [], aritSredina = arimetickaSredina(po)) {
        //let aritSredina = arimetickaSredina(po);
        let odstupanje = po.reduce((ak, val) => {
            return ak + Math.abs(Number(val) - aritSredina);
        }, 0)
        return (odstupanje / po.length).toFixed(2);

    }

    //console.log('prosjeƒçno odstupanje' ,prosAbOdstOdAritSred(polje))

    const varijanca = function (po = [], aritSredina = arimetickaSredina(po)) {
        let odstupanjeKvadratno = po.reduce((ak, val) => {
            return ak + Math.pow((Number(val) - aritSredina), 2);

        }, 0)
        return (odstupanjeKvadratno / po.length).toFixed(4);


    }

    const stanDevijacija = function (po = []) {
        return (Math.sqrt(varijanca(po))).toFixed(4);
    }

    //console.log('varijanca',varijanca(polje))

    //console.log('standardna devijacija',stanDevijacija(polje))



    const frekvencija = function (po = []) {
        let poSort = [...po].sort((a, b) => a - b);
        let prvi = poSort[0];
        let brojac = 0;
        let poljeFrek = [];
        //console.log('sortirani ulaz',poSort);
        const fukObj = function (ime, broj) {
            return { ime, broj };
        };

        const fukPolje = function (ime, broj) {
            return [ime, broj];
        };
        //izlaz objekt

        /*
        poljeFrek = poSort.reduce((ak,val)=>{
            if(val===prvi){
                brojac++;
                if(val===poSort[(poSort.length-1)]){
                ak.push(fukObj(prvi,brojac));
              }  
        
          }else{
              ak.push(fukObj(prvi,brojac));
              brojac=1;
        
              prvi = val;
              if(val===poSort[(poSort.length-1)]){
                ak.push(fukObj(prvi,brojac));
              }
          }
        */

        // izlaz polje
        poljeFrek = poSort.reduce((ak, val, i) => {
            if (val === prvi) {
                brojac++;
                if (i === (poSort.length - 1)) {
                    // console.log('fb',fukPolje(prvi,brojac))
                    ak.push(fukPolje(prvi, brojac));
                }

            } else {
                ak.push(fukPolje(prvi, brojac));
                brojac = 1;

                prvi = val;
                if (i === (poSort.length - 1)) {
                    //  console.log('fb',fukPolje(prvi,brojac))
                    ak.push(fukPolje(prvi, brojac));
                }

            }

            return ak;


        }, []);

        return poljeFrek;

    }


    const grupiranjeFrekvencija = function (po = [], raspon = 1) {


        let fren = frekvencija(po);
        const duzina = fren.length;
        let prvi = fren[0][0];
        let brojac = 0;
        let grupa = [];

        // console.log('frenkvencija',fren);
        for (let i = 0; i < duzina - 1; i++) {
            if ((fren[i][0] - prvi) < raspon) {
                brojac = brojac + fren[i][1];
                if (i === duzina - 2) {
                    grupa.push(brojac);
                }
            } else {
                grupa.push(brojac);
                brojac = fren[i][1];
                prvi = fren[i][0];

                if (i === duzina - 2) {
                    grupa.push(fren[duzina - 2][1]);
                    grupa.push(fren[duzina - 1][1]);
                }
            }



        }
        return grupa;

    }

    const dajNajmanje = function (po, x) {
        let rez = [];
        for (let i = 0; i < x; i++) {
            rez.push(po[0]);

        }
        return rez;
    }
    const relativnoStandardnoOdstupanje = function (po = []) {
        let x = arimetickaSredina(po);
        let s = stanDevijacija(po);


        let rsd = (s / x) * 100;
        if (isNaN(rsd)) rsd = 0;
        return rsd.toFixed(2);




    }



    const frekvencijePromise = function(polje=[],korak=1){

return new Promise((res,odb)=>{
let po = [...polje];
po.sort((a, b) => a - b)
//console.log(po);

let frekPolje = [];
let nutarnjePolje = [];
let prvi = Number(po[0]);

for (let i = 0; i < po.length; i++) {

    if ((Number(po[i]) - prvi) < korak) {
        nutarnjePolje.push(po[i]);
        if (i === (po.length - 1)) {
            frekPolje.push(nutarnjePolje);
        }

    } else {

        frekPolje.push(nutarnjePolje);
        nutarnjePolje = [];
        prvi = Number(po[i]);
        nutarnjePolje.push(po[i]);

        if (i === (po.length - 1)) {
            frekPolje.push(nutarnjePolje);

        }
    }
}
res(frekPolje);
odb('Gre≈°ka u obradi frekvencija')

})
}


    ///*******funkcija statistiƒçke obrade unos polje vrijednosti izlaz objekt sa vrijednostima

    const napraviObradu = function (deepPolje = [], x = deepPolje[0]) {
        let deepBezPrvog = deepPolje.slice(1, deepPolje.length);
        if (deepPolje.length <= 1) {
            deepBezPrvog = [0];
        };
        return {
            aritmetiƒçkaSredina: arimetickaSredina(deepPolje),
            medijan: medijan(deepPolje),
            raspon: [deepPolje[0], deepPolje[deepPolje.length - 1]],
            odstupanjeOdSredine: prosAbOdstOdAritSred(deepPolje, this.arimetickaSredina),
            varijanca: varijanca(deepPolje, this.aritmetiƒçkaSredina),
            standardnaDevijacija: stanDevijacija(deepPolje),
            // frekvencija:frekvencija(deepPolje),
            //grupiranjeFrekvencija:grupiranjeFrekvencija(deepPolje,5),
            najmanji: x,//deep[0]|| deepPolje[0],
            rsd: relativnoStandardnoOdstupanje(deepPolje),
            standarDevBezNajmanjeg: stanDevijacija(deepBezPrvog)


        };
    }


    //funkcija obrada podataka ulazni parametar je polje stanje
    const obradaPodataka = function (sta = []) {

        let deep = sta.filter(x => x.deep).sort((a, b) => a.prosjek - b.prosjek);
        let superf = sta.filter((x => x.superf)).sort((a, b) => a.prosjek - b.prosjek);

        let deepPolje = deep.length > 0 ? deep.map(x => x.prosjek) : [0];
        let superPolje = superf.length > 0 ? superf.map(x => x.prosjek) : [0];

        let deepObrada = napraviObradu(deepPolje, deep[0]);
        let superfObrada = napraviObradu(superPolje, superf[0]);



        return {
            deep,
            superf,
            deepObrada,
            superfObrada
        }

    }



    ////***********************crtanje grafa******************************


    
const nacrtajGrafCanvas = function(polje = []){
    //console.log('graf',polje);
    if ( polje.length>0){
    let zadnji = polje[polje.length-1];
    //console.log('zadnji',zadnji);
    let z ;
   if( zadnji===undefined){
       z=0;
   }else{
       z=zadnji[zadnji.length-1];
   }
   //console.log('z',z);
    let raspon = [polje[0][0],z];
 const razmak = 5;
let frek =Number( raspon[0]);
//console.log('frek',frek)

const boje = ["lightblue","lightgreen","pink","silver","lightblue","lightgreen","pink","silver","lightblue","lightgreen","pink","silver"]

let razlika = Number(raspon[1])-Number(raspon[0]);
//console.log('razlika',razlika)
let sirina = Math.ceil(razlika/ razmak);
if(sirina ===0) sirina =1;
//console.log('sirana',sirina)
//console.log('polje',polje,'raspon',raspon)
let faktor =Math.ceil( 240/razlika);
//console.log('faktor',faktor);
let brojStpoaca = polje.length;
let korak = Math.ceil( razlika/brojStpoaca)*faktor;
//console.log('korak',korak);

let can2 = document.createElement('canvas');
    can2.setAttribute('width','300px');
    can2.setAttribute('height','300px');



let graf = can2.getContext("2d");

graf.strokeRect(0,0,300,300)



let xGraf = 10;
let yGraf = 0;
let najveciStupac = polje.reduce((rez,val)=>{
   return rez<val.length?val.length:rez;

},-Infinity)
//console.log('najveci',najveciStupac);
let brojac = 0
console.log('grafx',xGraf);

const crtajGraf = function(x){
let visina = (x.length/najveciStupac)*300*0.8;
//console.log('visina',visina)
yGraf= 299-visina;
graf.fillStyle= boje[brojac] || "blue";
graf.fillRect(xGraf,yGraf,30,visina);
graf.save();
graf.font="20px Times";
graf.fillStyle = 'red';
graf.translate(xGraf+10,80)
//graf.rotate(90*Math.PI/180);
    graf.fillText(x.length,0,0)
    graf.restore();
    graf.save();
graf.font="10px Times";
graf.fillStyle = 'red';
graf.translate(xGraf+5,290)
//graf.rotate(90*Math.PI/180);
    graf.fillText(x[0],0,0)
    graf.restore(); 

xGraf = xGraf +korak;
brojac++
frek=frek+Number(sirina);
//console.log('frek2',frek,'sirina',sirina);
}


polje.forEach(crtajGraf)
return can2;
    }
    else {
        return document.createElement('div');
    }
 }



 

//
const dajDep = function (x=[],y=1){

let mapx = x.deep.map((x)=>x.prosjek);
frekvencijePromise(mapx,y)
       .then(x=>{

          // console.log('x',x);
          // console.log('stanjekn1',stanje);
          
          // console.log('stanjekn2',stanje);
        let graf = nacrtajGrafCanvas(x);
        kontejnerTablica.insertAdjacentHTML("beforeEnd","<h3>deep</h3>")
       // kontejnerTablica.appendChild(graf);
        kontejnerTablica.insertAdjacentElement('beforeEnd',graf);
        //console.log('deep frekvencija',x, 'raspon ', rasponD)
        }
       )

/*

x.deep.map((x)=>x.prosjek)
    //    .then(x=>frekvencija(x))
    //    .then(x=>grupiranjeFrekvencijaP(x,3))
    Promise.resolve(x)
    .then(x=>frekvencijePromise(x,8))
       .then(x=>{

          // console.log('x',x);
          // console.log('stanjekn1',stanje);
          
          // console.log('stanjekn2',stanje);
        let graf = nacrtajGrafCanvas(x);
        kontejnerTablica.insertAdjacentHTML("beforeEnd","<h3>deep</h3>")
       // kontejnerTablica.appendChild(graf);
        kontejnerTablica.insertAdjacentElement('beforeEnd',graf);
        console.log('deep frekvencija',x, 'raspon ', rasponD)}
       )
*/
}

const dajSuperf = function (x=[],y=1){
let mapx= x.superf.map((x)=>x.prosjek);

       frekvencijePromise(mapx,y)
       .then(x=>{
        let graf = nacrtajGrafCanvas(x);
        kontejnerTablica.insertAdjacentHTML("beforeEnd","<h3>superficijal</h3>")
       // kontejnerTablica.appendChild(graf);
        kontejnerTablica.insertAdjacentElement('beforeEnd',graf);
       // console.log('deep frekvencija',x, 'raspon ', rasponD)
        }
       )

}


const updateStanje = function(y=1){
//console.log ('rststanje',stanje)
//ƒçitaj sttanje
// iteriraj kroz stanje
// za svako stanje crtaj view
// let proba = [...obrada];
// console.log('update st pr',proba);

    napraviTablicuObrade2(obrada);
    dajDep(obrada,y);
    dajSuperf(obrada,y);
klasaKlizaci.style.display = "block";

}






    //*****************************POSTAVKE*******************************

    // Globalno dostupnpo Polje obraƒëenih slika za kasniju statistiƒçku analizu
    //Polje sadr≈æi objekte tipa {naslov:x,prosjek:y,rgbprosjek:z,deep:true}
    let stanje = [];
    let obrada =[];
    //let fileName ;



    // id kontejner
    const kontejner = document.getElementById('kontejner');
    const kontejnerTablica = document.getElementById('kontejnertablica')
    const spiner = document.getElementById('spiner');
    const linkObrada = document.getElementById('obrada');
    linkObrada.addEventListener('click',function(){
        if(obrada.deep||obrada.superf){
      // console.log('obrad',obrada.deep.length,'super',obrada.superf);
        updateStanje();
        klasaKlizaci.style.display = "block";
        }
    })

  // pokazivaƒç 
    const slider = document.getElementById('slider');
    const klasaKlizaci = document.querySelector(".klizac");

   klasaKlizaci.style.display ="none";
    const brojacSlider = document.getElementById("brojac__slider")
    slider.addEventListener("change",function(){
       // console.log("value",this.value);
        brojacSlider.innerHTML = this.value;
        updateStanje(this.value);
    })

    // id tablica
    const tablica = document.getElementById('tablica');

    // id skini tablicu kao text dokument
    // down load datoteke kao json iz podataka obrada
    const link = document.getElementById('link');
    link.download = 'tablica.txt';


    link.addEventListener('click', e => {


        let txt;
        let datum = Date.now();
        let ime = prompt("Unesite ime datoteke", "Datoteka");
        if (ime == null || ime == "") {
            return;
        } else {
            txt = ime + " " + datum + " JSON.json";
            link.download = txt;
        }

        // e.preventDefault();

        let ob = {};
        // ob.stanje = stanje;
        ob = Object.assign({}, obrada);
        //  console.log('ob0', ob);
        // console.log('obrada', obrada);
        let obJson = JSON.stringify(ob);
        // console.log('objson', obJson);



        // let pr = tablica.innerText;

        let blob1 = new Blob([obJson], { type: 'text/plain' });
        link.href = URL.createObjectURL(blob1);
        URL.revokeObjectURL(link.herf);

    })


    // selektor inputa file
    const fileInput = document.getElementById('file');
    fileInput.style.display = "none";

    // selekcija naslova za prikaz selektiranog elementa
    const prikazDat = document.getElementById('prikazdat');
    fileInput.addEventListener('change', () => {
        prikazDat.innerHTML = "";
        prikazDat.innerHTML = fileInput.files[0].name;
        gumb();
    })
    //  izaberi datoteku malo drukƒçije
    const izaberi = document.getElementById('izaberi');
    izaberi.addEventListener('click', e => {

        if (fileInput) {
            fileInput.click();
            // gumb();

        }
    }, false)




    /////// read filet ////

    function gumb(ev) {

        let brojFajlova = fileInput.files.length - 1;
       
        //console.log ('broj filova ',brojFajlova);

        setTimeout(window.requestAnimationFrame(() => spiner.innerHTML = `${brojFajlova} üêá`), 200);
        // selektira File input element

        // ƒçita vrijednost url selektiranog file
        // console.log ('fileinput',fileInput.files);
        let borojFile = fileInput.files.length - 1;
        const napraviFunkciju = function () {
            if(brojFajlova===-1)return;
            //// for (let ii = 0; ii < fileInput.files.length; ii++) {


            let fileName = fileInput.files[brojFajlova].name;
            while (!daliJeImeDeepiliSuperficijal(fileName)){
                brojFajlova--;
                if(brojFajlova===-1){
                    setTimeout(() => spiner.innerHTML = `üêú `, 5000);
                    return};
                fileName = fileInput.files[brojFajlova].name;

            }

            //let file = fileInput.files[ii];
            new Promise((res, odb) => {

                /////////////////////////////
                // kreira novi File reader objekt u koji ide podatak iz selektiranog file

                res(fileInput.files[brojFajlova]);
            })
                .then(file => {

                    let reader = new FileReader();
                    reader.readAsDataURL(file);

                    return reader;
                })
                .then(reader => {

                    // nakon ≈°to se uƒçita fajl koji je selektiran ide se dalje

                    reader.onload = function () {

                        const img = document.createElement("img");
                        // kreira div element za podatke ispod slike
                        const podaci = document.createElement("div");
                        // kreira potrebni redak i ƒáelije za kreiranje tablice sa podacima
                        const redak = document.createElement('tr');
                        const poljeN = document.createElement('td');
                        const poljeR = document.createElement('td');
                        const poljeP = document.createElement('td');







                        // rezultat uƒçitavanja slike pridru≈æuje se img elementu
                        img.src = reader.result;
                        // kada se uƒçita img element dalje se obra≈æuje kao canvas element
                        img.onload = () => {

                            // window.requestAnimationFrame(()=>spiner.innerHTML=`${brojFajlova} üêá`)

                            spiner.innerHTML = `${brojFajlova} üêá`;
                            if (Number(brojFajlova) === 0 || (Number(brojFajlova)) === 1) {
                                setTimeout(() => spiner.innerHTML = `üêú `, 5000)
                            }
                            borojFile--;
                            // original slika se meƒáe na stranicu
                            kontejner.appendChild(img);
                            //kreiraju se dva canvas elementa  jedan sa crveno zelenim slikama a jedan sa obrnutim koji nije aktiviran

                            let can = document.createElement('canvas');
                            let can1 = document.createElement('canvas');
                            //    can.width = img.width;
                            //    can.height = can.height;
                            const ctx = can.getContext('2d');
                            const ctx1 = can1.getContext('2d');


                            can.width = img.width;
                            can.height = img.height;
                            can1.width = img.width;
                            can1.height = img.height;

                            ctx.drawImage(img, 0, 0);
                            //ctx1.drawImage(img,0,0);
                            //img.style.display = 'none';
                            // iz original img slike radi se ImageData objekt te mu se skida naslov sa podacima te se dalje obraƒëuje bez naslova
                            const imgData = ctx.getImageData(0, 25, can.width, can.height - 25, 0, can.width, can.height - 25);
                            // ovaj je sa naslovom ukljiuƒçenim
                            // const imgData = ctx.getImageData(0,0,10,10);

                            // napravi se indexPolje formata [[rgba],[rgba].....]
                            const indexPolje = napraviRGB(imgData);

                            // raspodjel piksla 
                            //console.log( 'raspodjela',raspodjela(indexPolje));
                            //napravi prosjek RGB iz piksla
                            let RGBprosjek = dajProsjekRgb(indexPolje);

                            //napravi unit8 polje za obrnuti prikaz standardno iskljuƒçeno
                            //const obrnuto = Uint8ClampedArray.from(obrniRGB(imgData));

                            // Novi image Data objekt sa inverznim prikazom boja iskljuƒçen
                            //  const obData = new ImageData(obrnuto,can.width,can.height);
                            // Iz normalne slike radi vrveno zelenu
                            const crvenData = rafiniraj(indexPolje, RGBprosjek);
                            // const crvenData = rafiniraj(indexPolje,153);

                            let crvenDataF = crvenData.flat();
                            let crvenDataF8 = Uint8ClampedArray.from(crvenDataF);
                            const obData1 = new ImageData(crvenDataF8, can1.width, can1.height - 25);



                            // prosjeƒána boja na slici
                            let prosjek = (1 - prosjekRafinirani(indexPolje)) * 100;
                            // podaci u konzoli
                            // console.log('prosjek ', RGBprosjek)
                            //console.log('prosjek Rafinirani', prosjek);

                            prosjek = prosjek.toFixed(2);
                            let rGb = RGBprosjek;  // Math.ceil( dajProsjekRgb(indexPolje)[0],2);
                            // podaci ispod slike
                            podaci.innerHTML = ` RGB Prosjek ${rGb}  <br> 
    relativni postotak ≈æila na ukupnoj na slici ${ prosjek} %`;


                            // podaci za tablicu
                            poljeN.innerText = fileName;
                            poljeP.textContent = prosjek;
                            poljeR.textContent = rGb;
                            redak.appendChild(poljeN);
                            // redak.appendChild(poljeR);
                            redak.appendChild(poljeP);
                            tablica.append(redak);

                            // slika inverznih boja iskljuƒçeno
                            //ctx.putImageData(obData,0,0);

                            // canvas element sa crveno zelenom slikom iz originala
                            ctx1.putImageData(obData1, 0, 0);
                            //inverzna slika dodana u kontejner Iskljuƒçeno
                            // kontejner.appendChild(can);
                            /////NASLOV/////////
                            //kreira naslov slike iz podatka file.name i meƒáe ga na vrh slike
                            let naslov = document.createElement('h4');
                            naslov.innerHTML = fileName;

                            kontejner.appendChild(naslov);

                            // dadana canvas slika crveno zelena u kontejner
                            kontejner.appendChild(can1);

                            // dodana tablica u kontejner
                            kontejner.appendChild(podaci);
                            ////***********OBNOVA STANJA****************************************
                            stanje.push(napraviObjekt(fileName, prosjek, rGb))
                            // ********OBNOVA OBRADE**********************
                            obrada = Object.assign(obrada, obradaPodataka(stanje));

                            ////// rekurzivno poziva funkcijei nakon sto je img gotov
                            if (img.complete) {

                                if (brojFajlova > -1) {
                                    brojFajlova--;
                                    napraviFunkciju();
                                    
                                }

                            }

                        }


                    }
                })



        }
        /// pozcziva funkcij
        napraviFunkciju();

    }

</script>

</html>